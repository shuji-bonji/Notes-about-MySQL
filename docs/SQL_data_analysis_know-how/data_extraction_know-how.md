# データ抽出のノウハウ

SELECTと様々なSQL構文を利用したデータ参照の様々な方式を学習していきます。

```mysql
mysql> use ecsite;
Database changed

mysql> SHOW TABLES;
+----------------------------+
| Tables_in_ecsite           |
+----------------------------+
| order_details              |
| orders                     |
| product_browsing_histories |
| product_review_likes       |
| product_reviews            |
| products                   |
| users                      |
+----------------------------+
7 rows in set (0.00 sec)

show cloumns from users;

mysql> SHOW COLUMNS FROM users;
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | bigint(20)   | NO   | PRI | NULL    | auto_increment |
| email      | varchar(255) | NO   |     | NULL    |                |
| name       | varchar(255) | NO   |     | NULL    |                |
| gender     | tinyint(4)   | NO   |     | NULL    |                |
| birthday   | date         | NO   |     | NULL    |                |
| created_at | datetime(6)  | NO   |     | NULL    |                |
| updated_at | datetime(6)  | NO   |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+
7 rows in set (0.01 sec)

mysql> DESC users;
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | bigint(20)   | NO   | PRI | NULL    | auto_increment |
| email      | varchar(255) | NO   |     | NULL    |                |
| name       | varchar(255) | NO   |     | NULL    |                |
| gender     | tinyint(4)   | NO   |     | NULL    |                |
| birthday   | date         | NO   |     | NULL    |                |
| created_at | datetime(6)  | NO   |     | NULL    |                |
| updated_at | datetime(6)  | NO   |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+
7 rows in set (0.01 sec)


mysql> SHOW KEYS FROM users;
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| users |          0 | PRIMARY  |            1 | id          | A         |         100 |     NULL | NULL   |      | BTREE      |         |               |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
1 row in set (0.01 sec)

mysql> SHOW INDEX FROM users;
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| users |          0 | PRIMARY  |            1 | id          | A         |         100 |     NULL | NULL   |      | BTREE      |         |               |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
1 row in set (0.01 sec)

```


## SELECT文


### テーブル内の全てのデータを抽出

```mysql
mysql> SELECT * FROM users;
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
| id  | email                                | name                 | gender | birthday   | created_at                 | updated_at                 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
|   1 | jannie@dach.net                      | Erin Casper          |      2 | 1976-04-20 | 2020-04-07 04:33:58.399121 | 2020-04-07 04:33:58.399121 |
|   2 | louis.price@borer.co                 | Sudie Waelchi        |      1 | 1999-07-24 | 2020-04-07 04:33:58.402440 | 2020-04-07 04:33:58.402440 |
|   3 | joaquin.koepp@sawaynschuster.io      | Desire Osinski Sr.   |      1 | 2002-03-09 | 2020-04-07 04:33:58.405399 | 2020-04-07 04:33:58.405399 |
|   4 | michael@grant.org                    | Roy Yundt Jr.        |      0 | 1994-06-16 | 2020-04-07 04:33:58.407876 | 2020-04-07 04:33:58.407876 |
|   5 | fredrick_boyle@goyette.org           | Golden Kunde         |      1 | 1998-05-02 | 2020-04-07 04:33:58.410394 | 2020-04-07 04:33:58.410394 |
|   6 | felipe@nitzsche.name                 | Thaddeus Ledner      |      0 | 1962-07-30 | 2020-04-07 04:33:58.412617 | 2020-04-07 04:33:58.412617 |
|   7 | lesley_mitchell@damore.net           | Miss Rudy VonRueden  |      0 | 1968-03-08 | 2020-04-07 04:33:58.414754 | 2020-04-07 04:33:58.414754 |
|   8 | phyli.huel@boyer.co                  | Drusilla Larson      |      0 | 1964-11-26 | 2020-04-07 04:33:58.416812 | 2020-04-07 04:33:58.416812 |
|   9 | dirk.pagac@rosenbaumdaugherty.net    | Kip Raynor Jr.       |      1 | 1964-07-20 | 2020-04-07 04:33:58.418895 | 2020-04-07 04:33:58.418895 |
|  10 | linwood.vonrueden@hueljones.biz      | Coy Swaniawski       |      1 | 1978-03-12 | 2020-04-07 04:33:58.420987 | 2020-04-07 04:33:58.420987 |
.................
|  89 | rocio@gleichnerschiller.info         | Dorian Gislason      |      0 | 2004-04-09 | 2020-04-07 04:33:58.632453 | 2020-04-07 04:33:58.632453 |
|  90 | rae.streich@ruecker.org              | Annetta Friesen II   |      0 | 1979-07-20 | 2020-04-07 04:33:58.635035 | 2020-04-07 04:33:58.635035 |
|  91 | berniece@daugherty.io                | Rickie Littel        |      2 | 1978-11-05 | 2020-04-07 04:33:58.637453 | 2020-04-07 04:33:58.637453 |
|  92 | galen@wiegandmaggio.biz              | Truman Rogahn        |      0 | 1960-05-11 | 2020-04-07 04:33:58.639826 | 2020-04-07 04:33:58.639826 |
|  93 | kermit@vonshanahan.biz               | Soraya Luettgen      |      1 | 1963-11-30 | 2020-04-07 04:33:58.642277 | 2020-04-07 04:33:58.642277 |
|  94 | devora.douglas@nolanschowalter.co    | Pablo Huels Jr.      |      1 | 1967-08-27 | 2020-04-07 04:33:58.644634 | 2020-04-07 04:33:58.644634 |
|  95 | weldon@kaulke.name                   | Leonardo Turner      |      1 | 2004-11-13 | 2020-04-07 04:33:58.646703 | 2020-04-07 04:33:58.646703 |
|  96 | merna@steuberreilly.biz              | Augustine Cassin     |      1 | 1997-07-08 | 2020-04-07 04:33:58.648822 | 2020-04-07 04:33:58.648822 |
|  97 | yen_dickinson@kuhicdubuque.co        | Velva Nolan          |      1 | 2001-11-26 | 2020-04-07 04:33:58.650878 | 2020-04-07 04:33:58.650878 |
|  98 | valery@reilly.org                    | Maurice Koss         |      0 | 1987-03-25 | 2020-04-07 04:33:58.653008 | 2020-04-07 04:33:58.653008 |
|  99 | dennis@buckridge.co                  | Domingo Herman       |      0 | 1981-02-28 | 2020-04-07 04:33:58.654985 | 2020-04-07 04:33:58.654985 |
| 100 | hyman.boyer@mayert.name              | Barton Stracke       |      0 | 1995-03-24 | 2020-04-07 04:33:58.656992 | 2020-04-07 04:33:58.656992 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
100 rows in set (0.00 sec)
```

### フィールドのデータを抽出

```mysql
mysql> SELECT name FROM users;
+----------------------+
| name                 |
+----------------------+
| Erin Casper          |
| Sudie Waelchi        |
| Desire Osinski Sr.   |
| Roy Yundt Jr.        |
| Golden Kunde         |
| Thaddeus Ledner      |
......
| Soraya Luettgen      |
| Pablo Huels Jr.      |
| Leonardo Turner      |
| Augustine Cassin     |
| Velva Nolan          |
| Maurice Koss         |
| Domingo Herman       |
| Barton Stracke       |
+----------------------+
100 rows in set (0.01 sec)

```

### 複数のフィールドのデータを抽出

```mysql
mysql> SELECT id, name FROM users;
+-----+----------------------+
| id  | name                 |
+-----+----------------------+
|   1 | Erin Casper          |
|   2 | Sudie Waelchi        |
|   3 | Desire Osinski Sr.   |
|   4 | Roy Yundt Jr.        |
|   5 | Golden Kunde         |
|   6 | Thaddeus Ledner      |
............
|  95 | Leonardo Turner      |
|  96 | Augustine Cassin     |
|  97 | Velva Nolan          |
|  98 | Maurice Koss         |
|  99 | Domingo Herman       |
| 100 | Barton Stracke       |
+-----+----------------------+
100 rows in set (0.01 sec)

```

## WHERE句

SELECTを利用する際に活用して、データ参照条件を設定します。

### 条件を指定してレコードを取得する

```mysql

mysql> SELECT * FROM users WHERE birthday = "2002-03-09";
+----+---------------------------------+--------------------+--------+------------+----------------------------+----------------------------+
| id | email                           | name               | gender | birthday   | created_at                 | updated_at                 |
+----+---------------------------------+--------------------+--------+------------+----------------------------+----------------------------+
|  3 | joaquin.koepp@sawaynschuster.io | Desire Osinski Sr. |      1 | 2002-03-09 | 2020-04-07 04:33:58.405399 | 2020-04-07 04:33:58.405399 |
+----+---------------------------------+--------------------+--------+------------+----------------------------+----------------------------+
1 row in set (0.01 sec)


```

### 条件を指定して、特定のフィールドのデータを抽出する

```mysql
mysql> SELECT name, birthday FROM users WHERE birthday = "2002-03-09";
+--------------------+------------+
| name               | birthday   |
+--------------------+------------+
| Desire Osinski Sr. | 2002-03-09 |
+--------------------+------------+
1 row in set (0.00 sec)


```

### 複数の条件を指定して、特定のフィールドのデータを抽出する
```mysql
mysql>  SELECT name, birthday FROM users WHERE birthday = "2002-03-09" or birthday = "2003-06-07";
+--------------------+------------+
| name               | birthday   |
+--------------------+------------+
| Desire Osinski Sr. | 2002-03-09 |
| Darron Halvorson   | 2003-06-07 |
+--------------------+------------+
2 rows in set (0.01 sec)

```


## AS句

抽出したデータの表示タイトルを変更します。


### id を user_idとして表示しデータを抽出する

```mysql
mysql> SELECT id AS user_id FROM users;
+---------+
| user_id |
+---------+
|       1 |
|       2 |
|       3 |
|       4 |
|       5 |
....
|      92 |
|      93 |
|      94 |
|      95 |
|      96 |
|      97 |
|      98 |
|      99 |
|     100 |
+---------+
100 rows in set (0.00 sec)

```

### id を user_id、nameを fullname、 birthdayを DBBとして表示し、データを抽出する。

```mysql

mysql> SELECT id AS user_id, name AS fullname, birthday AS DDB FROM users;
+---------+----------------------+------------+
| user_id | fullname             | DDB        |
+---------+----------------------+------------+
|       1 | Erin Casper          | 1976-04-20 |
|       2 | Sudie Waelchi        | 1999-07-24 |
|       3 | Desire Osinski Sr.   | 2002-03-09 |
|       4 | Roy Yundt Jr.        | 1994-06-16 |
|       5 | Golden Kunde         | 1998-05-02 |
|       6 | Thaddeus Ledner      | 1962-07-30 |
....
|      97 | Velva Nolan          | 2001-11-26 |
|      98 | Maurice Koss         | 1987-03-25 |
|      99 | Domingo Herman       | 1981-02-28 |
|     100 | Barton Stracke       | 1995-03-24 |
+---------+----------------------+------------+
100 rows in set (0.01 sec)



```

## DISTINCT句
重複データを削除してデータを表示します。


サンプルの`order_details`テーブのデータです。

```mysql
mysql> SELECT * FROM order_details;
+-----+----------+------------+--------+----------------------------+----------------------------+
| id  | order_id | product_id | amount | created_at                 | updated_at                 |
+-----+----------+------------+--------+----------------------------+----------------------------+
|   1 |        2 |          1 |      1 | 2020-04-07 04:33:58.679643 | 2020-04-07 04:33:58.679643 |
|   2 |        2 |          2 |      2 | 2020-04-07 04:33:58.683224 | 2020-04-07 04:33:58.683224 |
|   3 |        2 |          3 |      2 | 2020-04-07 04:33:58.686672 | 2020-04-07 04:33:58.686672 |
|   4 |        2 |          4 |      2 | 2020-04-07 04:33:58.690540 | 2020-04-07 04:33:58.690540 |
..........
| 593 |      297 |          8 |      2 | 2020-04-07 04:34:01.230724 | 2020-04-07 04:34:01.230724 |
| 594 |      297 |          9 |      2 | 2020-04-07 04:34:01.233840 | 2020-04-07 04:34:01.233840 |
| 595 |      298 |          1 |      1 | 2020-04-07 04:34:01.238522 | 2020-04-07 04:34:01.238522 |
| 596 |      298 |          2 |      2 | 2020-04-07 04:34:01.240906 | 2020-04-07 04:34:01.240906 |
| 597 |      299 |          3 |      1 | 2020-04-07 04:34:01.245847 | 2020-04-07 04:34:01.245847 |
| 598 |      299 |          4 |      3 | 2020-04-07 04:34:01.248762 | 2020-04-07 04:34:01.248762 |
| 599 |      300 |          5 |      1 | 2020-04-07 04:34:01.254137 | 2020-04-07 04:34:01.254137 |
| 600 |      300 |          6 |      3 | 2020-04-07 04:34:01.256681 | 2020-04-07 04:34:01.256681 |
| 601 |      300 |          7 |      1 | 2020-04-07 04:34:01.259570 | 2020-04-07 04:34:01.259570 |
| 602 |      300 |          8 |      3 | 2020-04-07 04:34:01.262304 | 2020-04-07 04:34:01.262304 |
+-----+----------+------------+--------+----------------------------+----------------------------+
602 rows in set (0.02 sec)


```

### order_idの重複をデータ削除して表示

```mysql
mysql> SELECT DISTINCT order_id FROM order_details;
+----------+
| order_id |
+----------+
|        2 |
|        3 |
|        4 |
...
|      296 |
|      297 |
|      298 |
|      299 |
|      300 |
+----------+
229 rows in set (0.01 sec)
```


### 
```mysql
mysql> SELECT DISTINCT id, product_id FROM order_details;
+-----+------------+
| id  | product_id |
+-----+------------+
|   1 |          1 |
|  10 |          1 |
|  19 |          1 |
|  28 |          1 |
|  37 |          1 |
|  46 |          1 |
|  55 |          1 |
|  64 |          1 |
....
| 513 |          9 |
| 522 |          9 |
| 531 |          9 |
| 540 |          9 |
| 549 |          9 |
| 558 |          9 |
| 567 |          9 |
| 576 |          9 |
| 585 |          9 |
| 594 |          9 |
+-----+------------+
602 rows in set (0.01 sec)


```


## ORDER BY句

表示される順番を変更します。

対象のテーブルデータを参照してみます。

```mysql
mysql> SELECT * FROM users;
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
| id  | email                                | name                 | gender | birthday   | created_at                 | updated_at                 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
|   1 | jannie@dach.net                      | Erin Casper          |      2 | 1976-04-20 | 2020-04-07 04:33:58.399121 | 2020-04-07 04:33:58.399121 |
|   2 | louis.price@borer.co                 | Sudie Waelchi        |      1 | 1999-07-24 | 2020-04-07 04:33:58.402440 | 2020-04-07 04:33:58.402440 |
|   3 | joaquin.koepp@sawaynschuster.io      | Desire Osinski Sr.   |      1 | 2002-03-09 | 2020-04-07 04:33:58.405399 | 2020-04-07 04:33:58.405399 |
|   4 | michael@grant.org                    | Roy Yundt Jr.        |      0 | 1994-06-16 | 2020-04-07 04:33:58.407876 | 2020-04-07 04:33:58.407876 |
|   5 | fredrick_boyle@goyette.org           | Golden Kunde         |      1 | 1998-05-02 | 2020-04-07 04:33:58.410394 | 2020-04-07 04:33:58.410394 |
|   6 | felipe@nitzsche.name                 | Thaddeus Ledner      |      0 | 1962-07-30 | 2020-04-07 04:33:58.412617 | 2020-04-07 04:33:58.412617 |
|   7 | lesley_mitchell@damore.net           | Miss Rudy VonRueden  |      0 | 1968-03-08 | 2020-04-07 04:33:58.414754 | 2020-04-07 04:33:58.414754 |
|   8 | phyli.huel@boyer.co                  | Drusilla Larson      |      0 | 1964-11-26 | 2020-04-07 04:33:58.416812 | 2020-04-07 04:33:58.416812 |
|   9 | dirk.pagac@rosenbaumdaugherty.net    | Kip Raynor Jr.       |      1 | 1964-07-20 | 2020-04-07 04:33:58.418895 | 2020-04-07 04:33:58.418895 |
|  10 | linwood.vonrueden@hueljones.biz      | Coy Swaniawski       |      1 | 1978-03-12 | 2020-04-07 04:33:58.420987 | 2020-04-07 04:33:58.420987 |
...
|  90 | rae.streich@ruecker.org              | Annetta Friesen II   |      0 | 1979-07-20 | 2020-04-07 04:33:58.635035 | 2020-04-07 04:33:58.635035 |
|  91 | berniece@daugherty.io                | Rickie Littel        |      2 | 1978-11-05 | 2020-04-07 04:33:58.637453 | 2020-04-07 04:33:58.637453 |
|  92 | galen@wiegandmaggio.biz              | Truman Rogahn        |      0 | 1960-05-11 | 2020-04-07 04:33:58.639826 | 2020-04-07 04:33:58.639826 |
|  93 | kermit@vonshanahan.biz               | Soraya Luettgen      |      1 | 1963-11-30 | 2020-04-07 04:33:58.642277 | 2020-04-07 04:33:58.642277 |
|  94 | devora.douglas@nolanschowalter.co    | Pablo Huels Jr.      |      1 | 1967-08-27 | 2020-04-07 04:33:58.644634 | 2020-04-07 04:33:58.644634 |
|  95 | weldon@kaulke.name                   | Leonardo Turner      |      1 | 2004-11-13 | 2020-04-07 04:33:58.646703 | 2020-04-07 04:33:58.646703 |
|  96 | merna@steuberreilly.biz              | Augustine Cassin     |      1 | 1997-07-08 | 2020-04-07 04:33:58.648822 | 2020-04-07 04:33:58.648822 |
|  97 | yen_dickinson@kuhicdubuque.co        | Velva Nolan          |      1 | 2001-11-26 | 2020-04-07 04:33:58.650878 | 2020-04-07 04:33:58.650878 |
|  98 | valery@reilly.org                    | Maurice Koss         |      0 | 1987-03-25 | 2020-04-07 04:33:58.653008 | 2020-04-07 04:33:58.653008 |
|  99 | dennis@buckridge.co                  | Domingo Herman       |      0 | 1981-02-28 | 2020-04-07 04:33:58.654985 | 2020-04-07 04:33:58.654985 |
| 100 | hyman.boyer@mayert.name              | Barton Stracke       |      0 | 1995-03-24 | 2020-04-07 04:33:58.656992 | 2020-04-07 04:33:58.656992 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
100 rows in set (0.01 sec)

```

### 昇順に表示する


```mysql

mysql> SELECT *  FROM users ORDER BY name;
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
| id  | email                                | name                 | gender | birthday   | created_at                 | updated_at                 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
|  53 | kary.grimes@goyette.name             | Adalberto McClure    |      1 | 1981-01-29 | 2020-04-07 04:33:58.527016 | 2020-04-07 04:33:58.527016 |
|  21 | chia@mann.org                        | Agnes Stehr          |      2 | 1961-05-01 | 2020-04-07 04:33:58.445543 | 2020-04-07 04:33:58.445543 |
|  76 | raye.spencer@lowe.io                 | Al Gottlieb          |      1 | 2002-09-13 | 2020-04-07 04:33:58.604801 | 2020-04-07 04:33:58.604801 |
|  47 | annamarie@abernathy.co               | Aleida Ruecker       |      0 | 1996-06-26 | 2020-04-07 04:33:58.513845 | 2020-04-07 04:33:58.513845 |
|  23 | gregg.jacobs@baileyherzog.name       | Andera Torp          |      0 | 1997-11-17 | 2020-04-07 04:33:58.449924 | 2020-04-07 04:33:58.449924 |
|  90 | rae.streich@ruecker.org              | Annetta Friesen II   |      0 | 1979-07-20 | 2020-04-07 04:33:58.635035 | 2020-04-07 04:33:58.635035 |
....
|   6 | felipe@nitzsche.name                 | Thaddeus Ledner      |      0 | 1962-07-30 | 2020-04-07 04:33:58.412617 | 2020-04-07 04:33:58.412617 |
|  50 | gerry_balistreri@douglashills.name   | Theron Nolan         |      1 | 1985-03-07 | 2020-04-07 04:33:58.520850 | 2020-04-07 04:33:58.520850 |
|  92 | galen@wiegandmaggio.biz              | Truman Rogahn        |      0 | 1960-05-11 | 2020-04-07 04:33:58.639826 | 2020-04-07 04:33:58.639826 |
|  46 | reiko_stamm@ledner.name              | Ty Thompson PhD      |      0 | 1972-07-03 | 2020-04-07 04:33:58.511887 | 2020-04-07 04:33:58.511887 |
|  97 | yen_dickinson@kuhicdubuque.co        | Velva Nolan          |      1 | 2001-11-26 | 2020-04-07 04:33:58.650878 | 2020-04-07 04:33:58.650878 |
|  81 | nikia@rolfsonkunze.name              | Wilford Blick        |      2 | 1973-04-01 | 2020-04-07 04:33:58.615971 | 2020-04-07 04:33:58.615971 |
|  13 | gregory@sanfordbeier.com             | Zenaida Gorczany I   |      1 | 1991-03-27 | 2020-04-07 04:33:58.427887 | 2020-04-07 04:33:58.427887 |
+-----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+

```


#### フィールドを絞って昇順表示
```mysql
mysql> SELECT name FROM users ORDER BY name;
+----------------------+
| name                 |
+----------------------+
| Adalberto McClure    |
| Agnes Stehr          |
| Al Gottlieb          |
| Aleida Ruecker       |
| Andera Torp          |
| Annetta Friesen II   |
| Augustine Cassin     |
| Aurelio Jacobson     |
.......
| Theron Nolan         |
| Truman Rogahn        |
| Ty Thompson PhD      |
| Velva Nolan          |
| Wilford Blick        |
| Zenaida Gorczany I   |
+----------------------+
100 rows in set (0.01 sec)


```

```mysql
mysql> SELECT id, name, birthday FROM users ORDER BY name;
+-----+----------------------+------------+
| id  | name                 | birthday   |
+-----+----------------------+------------+
|  53 | Adalberto McClure    | 1981-01-29 |
|  21 | Agnes Stehr          | 1961-05-01 |
|  76 | Al Gottlieb          | 2002-09-13 |
|  47 | Aleida Ruecker       | 1996-06-26 |
|  23 | Andera Torp          | 1997-11-17 |
|  90 | Annetta Friesen II   | 1979-07-20 |
...
|   6 | Thaddeus Ledner      | 1962-07-30 |
|  50 | Theron Nolan         | 1985-03-07 |
|  92 | Truman Rogahn        | 1960-05-11 |
|  46 | Ty Thompson PhD      | 1972-07-03 |
|  97 | Velva Nolan          | 2001-11-26 |
|  81 | Wilford Blick        | 1973-04-01 |
|  13 | Zenaida Gorczany I   | 1991-03-27 |
+-----+----------------------+------------+
100 rows in set (0.00 sec)


```


### 降順に表示する


#### フィールドを降順に表示する

```mysql
mysql> SELECT name FROM users ORDER BY name DESC;
+----------------------+
| name                 |
+----------------------+
| Zenaida Gorczany I   |
| Wilford Blick        |
| Velva Nolan          |
.....
| Annetta Friesen II   |
| Andera Torp          |
| Aleida Ruecker       |
| Al Gottlieb          |
| Agnes Stehr          |
| Adalberto McClure    |
+----------------------+
100 rows in set (0.00 sec)
```

```mysql

mysql> SELECT id, name FROM users ORDER BY name DESC;
+-----+----------------------+
| id  | name                 |
+-----+----------------------+
|  13 | Zenaida Gorczany I   |
|  81 | Wilford Blick        |
|  97 | Velva Nolan          |
|  46 | Ty Thompson PhD      |
|  92 | Truman Rogahn        |
..........
|  23 | Andera Torp          |
|  47 | Aleida Ruecker       |
|  76 | Al Gottlieb          |
|  21 | Agnes Stehr          |
|  53 | Adalberto McClure    |
+-----+----------------------+
100 rows in set (0.01 sec)

```

#### カラム番号で指定してソートする

```mysql
mysql> SELECT id, name FROM users ORDER BY 1;
+-----+----------------------+
| id  | name                 |
+-----+----------------------+
|   1 | Erin Casper          |
|   2 | Sudie Waelchi        |
.......
|  96 | Augustine Cassin     |
|  97 | Velva Nolan          |
|  98 | Maurice Koss         |
|  99 | Domingo Herman       |
| 100 | Barton Stracke       |
+-----+----------------------+
100 rows in set (0.01 sec)


```

#### 複数のフィールド（カラム）を指定してソートする

```mysql

mysql> SELECT id, name, birthday FROM users ORDER BY name, birthday;
+-----+----------------------+------------+
| id  | name                 | birthday   |
+-----+----------------------+------------+
|  53 | Adalberto McClure    | 1981-01-29 |
|  21 | Agnes Stehr          | 1961-05-01 |
|  76 | Al Gottlieb          | 2002-09-13 |
|..
|  77 | Ta Jerde I           | 1994-07-22 |
|  31 | Tameka Hayes I       | 1989-01-05 |
|  32 | Tawnya Witting       | 1982-12-04 |
|   6 | Thaddeus Ledner      | 1962-07-30 |
|  50 | Theron Nolan         | 1985-03-07 |
|  92 | Truman Rogahn        | 1960-05-11 |
|  46 | Ty Thompson PhD      | 1972-07-03 |
|  97 | Velva Nolan          | 2001-11-26 |
|  81 | Wilford Blick        | 1973-04-01 |
|  13 | Zenaida Gorczany I   | 1991-03-27 |
+-----+----------------------+------------+
100 rows in set (0.01 sec)


```

## LIMET

表示されるデータの数を制限します。

#### 降順で10件表示する

```mysql

mysql> SELECT id, name FROM users ORDER BY id DESC LIMIT 10;
+-----+------------------+
| id  | name             |
+-----+------------------+
| 100 | Barton Stracke   |
|  99 | Domingo Herman   |
|  98 | Maurice Koss     |
|  97 | Velva Nolan      |
|  96 | Augustine Cassin |
|  95 | Leonardo Turner  |
|  94 | Pablo Huels Jr.  |
|  93 | Soraya Luettgen  |
|  92 | Truman Rogahn    |
|  91 | Rickie Littel    |
+-----+------------------+
10 rows in set (0.00 sec)



```

#### 降順で、（2つ覗いて）3番目から5件出力する

```mysql
mysql> SELECT id, name FROM users ORDER BY id DESC LIMIT 2,5;
+----+------------------+
| id | name             |
+----+------------------+
| 98 | Maurice Koss     |
| 97 | Velva Nolan      |
| 96 | Augustine Cassin |
| 95 | Leonardo Turner  |
| 94 | Pablo Huels Jr.  |
+----+------------------+
5 rows in set (0.01 sec)


```

#### 降順で、10除いてから10件表示する

```mysql
mysql> SELECT id, name FROM users ORDER BY id DESC LIMIT 10 OFFSET 10;
+----+----------------------+
| id | name                 |
+----+----------------------+
| 90 | Annetta Friesen II   |
| 89 | Dorian Gislason      |
| 88 | Hermina Wiegand      |
| 87 | Earnest Erdman       |
| 86 | Shawanda McGlynn     |
| 85 | Miss Majorie Goyette |
| 84 | Lanita Zboncak       |
| 83 | Danyell Price        |
| 82 | Elmira White         |
| 81 | Wilford Blick        |
+----+----------------------+
10 rows in set (0.00 sec)


```

## LIKE

ワイルドカード（%）を利用した部分検索を実施します。

```mysql
mysql> SELECT name FROM users WHERE name LIKE "%da%";
+--------------------+
| name               |
+--------------------+
| Zenaida Gorczany I |
| Darrick Lehner     |
| Darron Halvorson   |
| Aleida Ruecker     |
| Adalberto McClure  |
| Lyda Dare III      |
| Danette Collins    |
| Danyell Price      |
| Shawanda McGlynn   |
+--------------------+
9 rows in set (0.01 sec)
```


```mysql

mysql> SELECT name FROM users WHERE name LIKE "da%";
+------------------+
| name             |
+------------------+
| Darrick Lehner   |
| Darron Halvorson |
| Danette Collins  |
| Danyell Price    |
+------------------+
4 rows in set (0.00 sec)
```


```mysql

mysql> SELECT name FROM users WHERE name LIKE "%er";
+---------------------+
| name                |
+---------------------+
| Erin Casper         |
| Thaddeus Ledner     |
| Darrick Lehner      |
| Parthenia Hettinger |
| Dominica Harber     |
| Elinor Gleichner    |
| Denver Beier        |
| Mrs. Charity Kohler |
| Matt Schowalter     |
| Aleida Ruecker      |
| Dr. Gene Steuber    |
| Julio Cormier       |
| Lanny Boyer         |
| Junior Auer         |
| Betty Reinger       |
| Leonardo Turner     |
+---------------------+
16 rows in set (0.00 sec)

```


```mysql

mysql> SELECT * FROM users WHERE id LIKE '_';
+----+-----------------------------------+---------------------+--------+------------+----------------------------+----------------------------+
| id | email                             | name                | gender | birthday   | created_at                 | updated_at                 |
+----+-----------------------------------+---------------------+--------+------------+----------------------------+----------------------------+
|  1 | jannie@dach.net                   | Erin Casper         |      2 | 1976-04-20 | 2020-04-07 04:33:58.399121 | 2020-04-07 04:33:58.399121 |
|  2 | louis.price@borer.co              | Sudie Waelchi       |      1 | 1999-07-24 | 2020-04-07 04:33:58.402440 | 2020-04-07 04:33:58.402440 |
|  3 | joaquin.koepp@sawaynschuster.io   | Desire Osinski Sr.  |      1 | 2002-03-09 | 2020-04-07 04:33:58.405399 | 2020-04-07 04:33:58.405399 |
|  4 | michael@grant.org                 | Roy Yundt Jr.       |      0 | 1994-06-16 | 2020-04-07 04:33:58.407876 | 2020-04-07 04:33:58.407876 |
|  5 | fredrick_boyle@goyette.org        | Golden Kunde        |      1 | 1998-05-02 | 2020-04-07 04:33:58.410394 | 2020-04-07 04:33:58.410394 |
|  6 | felipe@nitzsche.name              | Thaddeus Ledner     |      0 | 1962-07-30 | 2020-04-07 04:33:58.412617 | 2020-04-07 04:33:58.412617 |
|  7 | lesley_mitchell@damore.net        | Miss Rudy VonRueden |      0 | 1968-03-08 | 2020-04-07 04:33:58.414754 | 2020-04-07 04:33:58.414754 |
|  8 | phyli.huel@boyer.co               | Drusilla Larson     |      0 | 1964-11-26 | 2020-04-07 04:33:58.416812 | 2020-04-07 04:33:58.416812 |
|  9 | dirk.pagac@rosenbaumdaugherty.net | Kip Raynor Jr.      |      1 | 1964-07-20 | 2020-04-07 04:33:58.418895 | 2020-04-07 04:33:58.418895 |
+----+-----------------------------------+---------------------+--------+------------+----------------------------+----------------------------+
9 rows in set (0.01 sec)

```

```mysql
mysql> SELECT * FROM users WHERE id LIKE '__';
+----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
| id | email                                | name                 | gender | birthday   | created_at                 | updated_at                 |
+----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
| 10 | linwood.vonrueden@hueljones.biz      | Coy Swaniawski       |      1 | 1978-03-12 | 2020-04-07 04:33:58.420987 | 2020-04-07 04:33:58.420987 |
| 11 | sean@labadie.co                      | Hong Wisozk IV       |      2 | 1962-08-03 | 2020-04-07 04:33:58.423240 | 2020-04-07 04:33:58.423240 |
| 12 | kayce_gulgowski@hodkiewicz.info      | Jerold Satterfield   |      0 | 2000-06-26 | 2020-04-07 04:33:58.425603 | 2020-04-07 04:33:58.425603 |
| 13 | gregory@sanfordbeier.com             | Zenaida Gorczany I   |      1 | 1991-03-27 | 2020-04-07 04:33:58.427887 | 2020-04-07 04:33:58.427887 |
| 14 | silva@cremin.org                     | Ivory King           |      0 | 1963-05-10 | 2020-04-07 04:33:58.429979 | 2020-04-07 04:33:58.429979 |
.......
| 95 | weldon@kaulke.name                   | Leonardo Turner      |      1 | 2004-11-13 | 2020-04-07 04:33:58.646703 | 2020-04-07 04:33:58.646703 |
| 96 | merna@steuberreilly.biz              | Augustine Cassin     |      1 | 1997-07-08 | 2020-04-07 04:33:58.648822 | 2020-04-07 04:33:58.648822 |
| 97 | yen_dickinson@kuhicdubuque.co        | Velva Nolan          |      1 | 2001-11-26 | 2020-04-07 04:33:58.650878 | 2020-04-07 04:33:58.650878 |
| 98 | valery@reilly.org                    | Maurice Koss         |      0 | 1987-03-25 | 2020-04-07 04:33:58.653008 | 2020-04-07 04:33:58.653008 |
| 99 | dennis@buckridge.co                  | Domingo Herman       |      0 | 1981-02-28 | 2020-04-07 04:33:58.654985 | 2020-04-07 04:33:58.654985 |
+----+--------------------------------------+----------------------+--------+------------+----------------------------+----------------------------+
90 rows in set (0.00 sec)

```

## GROUP BY
一定の条件に基づいて、抽出されたデータをグループ化して表示します


以下は、`product_id`毎に、いくつ注文されたか個数（`amount`）の合計を算出しています。

```mysql
mysql> SELECT product_id, SUM(amount) FROM order_details GROUP BY product_id ;
+------------+-------------+
| product_id | SUM(amount) |
+------------+-------------+
|          1 |         139 |
|          2 |         135 |
|          3 |         134 |
|          4 |         132 |
|          5 |         136 |
|          6 |         131 |
|          7 |         136 |
|          8 |         141 |
|          9 |         136 |
+------------+-------------+
9 rows in set (0.01 sec)

```

!!!note
	下記はグループ化した最初のレコードだけを表示してます。
	```mysql
	mysql> SELECT * FROM order_details GROUP BY amount;
	+----+----------+------------+--------+----------------------------+----------------------------+
	| id | order_id | product_id | amount | created_at                 | updated_at                 |
	+----+----------+------------+--------+----------------------------+----------------------------+
	|  1 |        2 |          1 |      1 | 2020-04-07 04:33:58.679643 | 2020-04-07 04:33:58.679643 |
	|  2 |        2 |          2 |      2 | 2020-04-07 04:33:58.683224 | 2020-04-07 04:33:58.683224 |
	|  5 |        3 |          5 |      3 | 2020-04-07 04:33:58.707116 | 2020-04-07 04:33:58.707116 |
	+----+----------+------------+--------+----------------------------+----------------------------+
	3 rows in set (0.01 sec)
	```

### 条件指定してグループ化し表示する

order_id ２桁のもので、amountでグループ化

```mysql
mysql> SELECT * FROM order_details WHERE order_id LIKE '__' GROUP BY amount;
+----+----------+------------+--------+----------------------------+----------------------------+
| id | order_id | product_id | amount | created_at                 | updated_at                 |
+----+----------+------------+--------+----------------------------+----------------------------+
| 30 |       12 |          3 |      1 | 2020-04-07 04:33:58.805487 | 2020-04-07 04:33:58.805487 |
| 26 |       10 |          8 |      2 | 2020-04-07 04:33:58.790826 | 2020-04-07 04:33:58.790826 |
| 25 |       10 |          7 |      3 | 2020-04-07 04:33:58.787906 | 2020-04-07 04:33:58.787906 |
+----+----------+------------+--------+----------------------------+----------------------------+
3 rows in set (0.01 sec)



```


## HAVING

GROUP BYによってグループ化したデータをさらに絞り込みます


```mysql
mysql> SELECT product_id, SUM(amount) FROM order_details GROUP BY product_id HAVING product_id = 5;
+------------+-------------+
| product_id | SUM(amount) |
+------------+-------------+
|          5 |         136 |
+------------+-------------+
1 row in set (0.01 sec)

```

!!! note
	上記の条件だと、もともとグループ化する必要もない（例えが悪いかもしれない）

	```mysql
	mysql> SELECT product_id, SUM(amount) FROM order_details  WHERE product_id LIKE '5';
	+------------+-------------+
	| product_id | SUM(amount) |
	+------------+-------------+
	|          5 |         136 |
	+------------+-------------+
	1 row in set (0.01 sec)


	```


## 演習

### 6月のユーザリストを抽出する

`id`, `name`, `birthday` のカラムを対象とする、6月のユーザリストを抽出する


```mysql
mysql> SELECT id, name, birthday FROM users WHERE birthday LIKE '%-06-%';
+----+--------------------+------------+
| id | name               | birthday   |
+----+--------------------+------------+
|  4 | Roy Yundt Jr.      | 1994-06-16 |
| 12 | Jerold Satterfield | 2000-06-26 |
| 20 | Darron Halvorson   | 2003-06-07 |
| 45 | Matt Schowalter    | 1989-06-15 |
| 47 | Aleida Ruecker     | 1996-06-26 |
| 63 | Otelia Kirlin      | 2004-06-22 |
| 86 | Shawanda McGlynn   | 1966-06-08 |
+----+--------------------+------------+
7 rows in set, 1 warning (0.01 sec)

```


### ユーザのIDが最も大きい番号の１名のユーザのレコードを抽出する

```mysql
mysql> SELECT * FROM users ORDER BY id DESC LIMIT 1;
+-----+-------------------------+----------------+--------+------------+----------------------------+----------------------------+
| id  | email                   | name           | gender | birthday   | created_at                 | updated_at                 |
+-----+-------------------------+----------------+--------+------------+----------------------------+----------------------------+
| 100 | hyman.boyer@mayert.name | Barton Stracke |      0 | 1995-03-24 | 2020-04-07 04:33:58.656992 | 2020-04-07 04:33:58.656992 |
+-----+-------------------------+----------------+--------+------------+----------------------------+----------------------------+
1 row in set (0.01 sec)

```

### order_id が2桁のユーザの中から、 product_idが6番のorder_detailsテーブルデータ

```sql

mysql> SELECT * FROM order_details WHERE order_id LIKE  '__' AND product_id = 6;
+-----+----------+------------+--------+----------------------------+----------------------------+
| id  | order_id | product_id | amount | created_at                 | updated_at                 |
+-----+----------+------------+--------+----------------------------+----------------------------+
|  33 |       13 |          6 |      2 | 2020-04-07 04:33:58.816336 | 2020-04-07 04:33:58.816336 |
|  42 |       17 |          6 |      2 | 2020-04-07 04:33:58.859844 | 2020-04-07 04:33:58.859844 |
|  51 |       22 |          6 |      3 | 2020-04-07 04:33:58.899822 | 2020-04-07 04:33:58.899822 |
|  60 |       26 |          6 |      2 | 2020-04-07 04:33:58.933921 | 2020-04-07 04:33:58.933921 |
|  69 |       30 |          6 |      1 | 2020-04-07 04:33:58.975404 | 2020-04-07 04:33:58.975404 |
|  78 |       35 |          6 |      1 | 2020-04-07 04:33:59.024549 | 2020-04-07 04:33:59.024549 |
|  87 |       39 |          6 |      1 | 2020-04-07 04:33:59.070273 | 2020-04-07 04:33:59.070273 |
|  96 |       46 |          6 |      1 | 2020-04-07 04:33:59.119317 | 2020-04-07 04:33:59.119317 |
| 105 |       49 |          6 |      3 | 2020-04-07 04:33:59.151205 | 2020-04-07 04:33:59.151205 |
| 114 |       54 |          6 |      2 | 2020-04-07 04:33:59.197627 | 2020-04-07 04:33:59.197627 |
| 123 |       63 |          6 |      1 | 2020-04-07 04:33:59.239999 | 2020-04-07 04:33:59.239999 |
| 132 |       68 |          6 |      1 | 2020-04-07 04:33:59.272952 | 2020-04-07 04:33:59.272952 |
| 141 |       72 |          6 |      1 | 2020-04-07 04:33:59.315548 | 2020-04-07 04:33:59.315548 |
| 150 |       74 |          6 |      2 | 2020-04-07 04:33:59.343095 | 2020-04-07 04:33:59.343095 |
| 159 |       76 |          6 |      3 | 2020-04-07 04:33:59.367926 | 2020-04-07 04:33:59.367926 |
| 168 |       85 |          6 |      1 | 2020-04-07 04:33:59.410906 | 2020-04-07 04:33:59.410906 |
| 177 |       91 |          6 |      2 | 2020-04-07 04:33:59.465129 | 2020-04-07 04:33:59.465129 |
| 186 |       96 |          6 |      2 | 2020-04-07 04:33:59.500138 | 2020-04-07 04:33:59.500138 |
+-----+----------+------------+--------+----------------------------+----------------------------+
18 rows in set (0.01 sec)

mysql> SELECT * FROM order_details WHERE product_id = 6 AND order_id LIKE  '__';
+-----+----------+------------+--------+----------------------------+----------------------------+
| id  | order_id | product_id | amount | created_at                 | updated_at                 |
+-----+----------+------------+--------+----------------------------+----------------------------+
|  33 |       13 |          6 |      2 | 2020-04-07 04:33:58.816336 | 2020-04-07 04:33:58.816336 |
|  42 |       17 |          6 |      2 | 2020-04-07 04:33:58.859844 | 2020-04-07 04:33:58.859844 |
|  51 |       22 |          6 |      3 | 2020-04-07 04:33:58.899822 | 2020-04-07 04:33:58.899822 |
|  60 |       26 |          6 |      2 | 2020-04-07 04:33:58.933921 | 2020-04-07 04:33:58.933921 |
|  69 |       30 |          6 |      1 | 2020-04-07 04:33:58.975404 | 2020-04-07 04:33:58.975404 |
|  78 |       35 |          6 |      1 | 2020-04-07 04:33:59.024549 | 2020-04-07 04:33:59.024549 |
|  87 |       39 |          6 |      1 | 2020-04-07 04:33:59.070273 | 2020-04-07 04:33:59.070273 |
|  96 |       46 |          6 |      1 | 2020-04-07 04:33:59.119317 | 2020-04-07 04:33:59.119317 |
| 105 |       49 |          6 |      3 | 2020-04-07 04:33:59.151205 | 2020-04-07 04:33:59.151205 |
| 114 |       54 |          6 |      2 | 2020-04-07 04:33:59.197627 | 2020-04-07 04:33:59.197627 |
| 123 |       63 |          6 |      1 | 2020-04-07 04:33:59.239999 | 2020-04-07 04:33:59.239999 |
| 132 |       68 |          6 |      1 | 2020-04-07 04:33:59.272952 | 2020-04-07 04:33:59.272952 |
| 141 |       72 |          6 |      1 | 2020-04-07 04:33:59.315548 | 2020-04-07 04:33:59.315548 |
| 150 |       74 |          6 |      2 | 2020-04-07 04:33:59.343095 | 2020-04-07 04:33:59.343095 |
| 159 |       76 |          6 |      3 | 2020-04-07 04:33:59.367926 | 2020-04-07 04:33:59.367926 |
| 168 |       85 |          6 |      1 | 2020-04-07 04:33:59.410906 | 2020-04-07 04:33:59.410906 |
| 177 |       91 |          6 |      2 | 2020-04-07 04:33:59.465129 | 2020-04-07 04:33:59.465129 |
| 186 |       96 |          6 |      2 | 2020-04-07 04:33:59.500138 | 2020-04-07 04:33:59.500138 |
+-----+----------+------------+--------+----------------------------+----------------------------+
18 rows in set (0.01 sec)


```

### 20代のユーザに絞り込んで抽出

現在は2001年1月1日

```mysql
mysql> SELECT id, name, birthday FROM users WHERE birthday LIKE '20%' ;
+----+--------------------+------------+
| id | name               | birthday   |
+----+--------------------+------------+
|  3 | Desire Osinski Sr. | 2002-03-09 |
| 12 | Jerold Satterfield | 2000-06-26 |
| 20 | Darron Halvorson   | 2003-06-07 |
| 33 | Myrtie Ullrich     | 2004-04-11 |
| 34 | Nydia Marquardt IV | 2003-04-03 |
| 37 | Kenneth Prosacco   | 2002-10-14 |
| 56 | Lyda Dare III      | 2003-02-01 |
| 63 | Otelia Kirlin      | 2004-06-22 |
| 76 | Al Gottlieb        | 2002-09-13 |
| 83 | Danyell Price      | 2004-10-21 |
| 89 | Dorian Gislason    | 2004-04-09 |
| 95 | Leonardo Turner    | 2004-11-13 |
| 97 | Velva Nolan        | 2001-11-26 |
+----+--------------------+------------+
13 rows in set, 1 warning (0.01 sec)



```

### 一度でもオーダーを行ったユーザ

```mysql

mysql> SELECT DISTINCT user_id FROM orders;
+---------+
| user_id |
+---------+
|       1 |
|       2 |
|       3 |
|       4 |
|       5 |
|       6 |
|       7 |
......
|      80 |
|      81 |
|      82 |
|      83 |
|      84 |
|      85 |
|      86 |
|      87 |
|      88 |
|      89 |
|      90 |
|      91 |
|      92 |
|      93 |
|      94 |
|      95 |
|      96 |
|      97 |
|      98 |
|      99 |
+---------+
98 rows in set (0.01 sec)

```

### 発注数が2個以上で、product_idでグループ化して製品リストを作成する


```mysql
mysql> SELECT * FROM order_details WHERE amount > 2 ORDER BY product_id;
+-----+----------+------------+--------+----------------------------+----------------------------+
| id  | order_id | product_id | amount | created_at                 | updated_at                 |
+-----+----------+------------+--------+----------------------------+----------------------------+
|  19 |        7 |          1 |      3 | 2020-04-07 04:33:58.764579 | 2020-04-07 04:33:58.764579 |
|  28 |       10 |          1 |      3 | 2020-04-07 04:33:58.796088 | 2020-04-07 04:33:58.796088 |
|  37 |       14 |          1 |      3 | 2020-04-07 04:33:58.830067 | 2020-04-07 04:33:58.830067 |
|  73 |       32 |          1 |      3 | 2020-04-07 04:33:58.990538 | 2020-04-07 04:33:58.990538 |
|  91 |       40 |          1 |      3 | 2020-04-07 04:33:59.087086 | 2020-04-07 04:33:59.087086 |
........
| 378 |      192 |          9 |      3 | 2020-04-07 04:34:00.308048 | 2020-04-07 04:34:00.308048 |
| 432 |      216 |          9 |      3 | 2020-04-07 04:34:00.517064 | 2020-04-07 04:34:00.517064 |
| 486 |      242 |          9 |      3 | 2020-04-07 04:34:00.751014 | 2020-04-07 04:34:00.751014 |
| 495 |      245 |          9 |      3 | 2020-04-07 04:34:00.787409 | 2020-04-07 04:34:00.787409 |
| 513 |      256 |          9 |      3 | 2020-04-07 04:34:00.861625 | 2020-04-07 04:34:00.861625 |
| 549 |      277 |          9 |      3 | 2020-04-07 04:34:01.057458 | 2020-04-07 04:34:01.057458 |
| 576 |      290 |          9 |      3 | 2020-04-07 04:34:01.158766 | 2020-04-07 04:34:01.158766 |
| 585 |      293 |          9 |      3 | 2020-04-07 04:34:01.201492 | 2020-04-07 04:34:01.201492 |
+-----+----------+------------+--------+----------------------------+----------------------------+
202 rows in set (0.01 sec)


```

```mysql
mysql> SELECT * FROM order_details GROUP BY product_id HAVING amount > 1;
+----+----------+------------+--------+----------------------------+----------------------------+
| id | order_id | product_id | amount | created_at                 | updated_at                 |
+----+----------+------------+--------+----------------------------+----------------------------+
|  2 |        2 |          2 |      2 | 2020-04-07 04:33:58.683224 | 2020-04-07 04:33:58.683224 |
|  3 |        2 |          3 |      2 | 2020-04-07 04:33:58.686672 | 2020-04-07 04:33:58.686672 |
|  4 |        2 |          4 |      2 | 2020-04-07 04:33:58.690540 | 2020-04-07 04:33:58.690540 |
|  5 |        3 |          5 |      3 | 2020-04-07 04:33:58.707116 | 2020-04-07 04:33:58.707116 |
|  8 |        3 |          8 |      3 | 2020-04-07 04:33:58.717463 | 2020-04-07 04:33:58.717463 |
|  9 |        4 |          9 |      3 | 2020-04-07 04:33:58.726347 | 2020-04-07 04:33:58.726347 |
+----+----------+------------+--------+----------------------------+----------------------------+
6 rows in set (0.01 sec)


```


